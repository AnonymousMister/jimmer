---
sidebar_position: 2
title: Create Database  
---

## UML

The examples in this tutorial require the following four entity types:

![uml](@site/static/img/uml.svg)

- BookStore, Book, Author:
    Demonstrate various associations including one-to-many, many-to-one, many-to-many.

- TreeNode:
    Demonstrates infinite recursion/self-referencing to show recursive queries and saving in later examples.

## Create SQL File

This tutorial uses MySQL. Create a new SQL file `jimmer-demo.sql` with the following code:

```sql
create database jimmer_demo;
use jimmer_demo;

create table book_store(
    id bigint unsigned not null auto_increment primary key, 
    name varchar(50) not null,
    website varchar(100)
) engine=innodb;

... 

create table book (
    id bigint unsigned not null auto_increment primary key,
    name varchar(50) not null,  
    edition integer not null,
    price numeric(10, 2) not null,
    store_id bigint unsigned  
) engine=innodb;   

...

create table author(
   id bigint unsigned not null auto_increment primary key,
   first_name varchar(25) not null,
   last_name varchar(25) not null,
   gender char(1) not null, 
   created_time datetime not null,
   modified_time datetime not null
) engine=innodb;

...

/*
Many-to-many relationship between entities requires join table in ORM implementation.

This table stores many-to-many mapping between books and authors. It is a join table, 
not an entity table, so no corresponding entity in the UML diagram above.  
*/
create table book_author_mapping(
    book_id bigint unsigned not null,
    author_id bigint unsigned not null
) engine=innodb;

...

create table tree_node(
    node_id bigint unsigned not null auto_increment primary key,
    name varchar(20) not null,
    parent_id bigint unsigned  
) engine=innodb;

...

insert into book_store(id, name) values
   (1, 'O''REILLY'),
   (2, 'MANNING');

... 

insert into tree_node(
    node_id, name, parent_id    
) values
    (1, 'Home', null),
        (2, 'Food', 1),
            (3, 'Drinks', 2),
            ...
;
```

This SQL file shows:

- Entity tables - `book_store`, `book`, `author`, `tree_node` map to entities in UML
- Join table - `book_author_mapping` represents many-to-many mapping between Book and Author

:::note
This is a basic database structure. More fields will be added in later tutorials. 

See https://github.com/babyfish-ct/jimmer/blob/main/example/env-with-cache/jimmer-demo.sql for full SQL.
:::


## Create Database

Install Docker. Open a command line, navigate to the SQL file directory, and run:

```shell
docker run \ 
    --name jimmer-demo-mysql \
    ...
    mysql \
    --lower_case_table_names=1
    
docker cp jimmer-demo.sql jimmer-demo-mysql:/var/jimmer-demo.sql

docker exec jimmer-demo-mysql /bin/sh -c \
        'mysql -uroot -p123456 </var/jimmer-demo.sql' 
```
